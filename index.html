<html>
    <head>
        <script src="lib/vendor/gamepad.js" type="text/javascript"></script>

        <script src="lib/vendor/neon.js" type="text/javascript"></script>
        <script src="lib/vendor/NodeSupport.js" type="text/javascript"></script>
        <script src="lib/vendor/CustomEvent.js" type="text/javascript"></script>
        <script src="lib/vendor/CustomEventSupport.js" type="text/javascript"></script>
        <script src="lib/vendor/BubblingSupport.js" type="text/javascript"></script>
        <script src="lib/vendor/Widget.js" type="text/javascript"></script>

        <script src="lib/vendor/jquery-1.9.1.js" type="text/javascript"></script>

        <script src="lib/entities/entity.js" type="text/javascript"></script>
        <script src="lib/entities/circle.js" type="text/javascript"></script>
        <script src="lib/entities/triangle.js" type="text/javascript"></script>
        <script src="lib/entities/rectangle.js" type="text/javascript"></script>
        <script src="lib/behaviors/behavior.js" type="text/javascript"></script>
        <script src="lib/behaviors/swinger.js" type="text/javascript"></script>
        <script src="lib/behaviors/rotator.js" type="text/javascript"></script>
        <script src="lib/player.js" type="text/javascript"></script>
        <script src="lib/timeLapseSupport.js" type="text/javascript"></script>
        <script src="lib/game.js" type="text/javascript"></script>

        <script src="lib/tools/controls.js" type="text/javascript"></script>
        <script src="lib/tools/level_editor.js" type="text/javascript"></script>
        <style>
            canvas { border: 2px solid black; }
            .slider .label { display: block; }
            .slider { float: left; }
        </style>
    </head>
    <body>
        <canvas id="canvas"></canvas>
        <div id="controls"></div>

        <script type="text/javascript">
            var levelConfig = {
                enemies : [
                    ['CIR', 600, 200, 30],
                    ['ROT', 2,
                        ['TRI', 400, 300, 30]],
                    ['SWI', 2, 180, 90,
                        ['REC', 800, 100, 20, 100]],
                    ['ROT', 2,
                        ['SWI', 4, 180, 0,
                            ['ROT', 2,
                                ['REC', 1000, 200, 40, 40]]]]
                ]
            }

            var initialConfig = {
                scrollSpeed : 7,
                playerSpeed : 18,
                dashSpeed : 10,
                dashDuration : 20,
                dashCooldown : 10,
                playerActionCooldown : 20
            };
            var game = new Game(initialConfig);
            game.loadLevel(levelConfig);
            game.run();

            window.game = game;

            var createSliderControl = function(target, settings) {
                (new Controls.Slider(settings)).
                    bindValue(game.settings, target).
                    render($('#controls'));
            };

            createSliderControl('scrollSpeed', {
                min : 3,
                max : 30,
                step : 0.5,
                value : initialConfig.scrollSpeed
            });

            createSliderControl('playerSpeed', {
                min : 15,
                max : 30,
                step : 0.5,
                value : initialConfig.playerSpeed
            });

            createSliderControl('dashSpeed', {
                min : 5,
                max : 20,
                step : 1,
                value : initialConfig.dashSpeed
            });

            createSliderControl('dashDuration', {
                min : 10,
                max : 40,
                step : 1,
                value : initialConfig.dashDuration
            });

            createSliderControl('dashCooldown', {
                min : 5,
                max : 30,
                step : 1,
                value : initialConfig.dashCooldown
            });

            var levelEditor = new LevelEditor({
                level : levelConfig
            });

            levelEditor.render($('#controls'));

            levelEditor.bind('level:load:success', function(event) {
               game.restart(event.level);
            });
            levelEditor.load('default.json');
          </script>
    </body>
</html>